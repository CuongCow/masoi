<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta tags cơ bản -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản Trò Ma Sói | Công Cụ Quản Trò Ma Sói Offline</title>
    <meta name="description" content="Công cụ quản trò ma sói miễn phí, dễ sử dụng dành cho quản trò ma sói offline. Hỗ trợ đầy đủ các chức năng: phân vai, đếm giờ ngày đêm, quản lý người chơi.">
    
    <!-- Meta tags cho SEO -->
    <meta name="keywords" content="quản trò ma sói, app quản trò, app quản trò ma sói, app quản trò ma sói offline, ma sói offline, game ma sói, ma sói ngoài đời, công cụ quản trò ma sói, phần mềm quản trò ma sói">
    <meta name="author" content="Đam Mê Kỹ Năng">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph tags cho mạng xã hội -->
    <meta property="og:title" content="Quản Trò Ma Sói | Công Cụ Quản Trò Ma Sói Offline">
    <meta property="og:description" content="Công cụ quản trò ma sói miễn phí, dễ sử dụng dành cho quản trò ma sói offline. Hỗ trợ đầy đủ các chức năng: phân vai, đếm giờ ngày đêm, quản lý người chơi.">
    <meta property="og:image" content="https://dammekynang.id.vn/masoi/images/roles/wolf.png">
    <meta property="og:url" content="https://dammekynang.id.vn/masoi/quantro.html">
    
    <!-- Schema Markup -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Quản Trò Ma Sói",
      "description": "Công cụ quản trò ma sói miễn phí, dễ sử dụng dành cho quản trò ma sói offline",
      "applicationCategory": "Game",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "VND"
      },
      "featureList": [
        "Phân vai tự động",
        "Đếm giờ ngày đêm",
        "Quản lý người chơi",
        "Ghi chú diễn biến game"
      ]
    }
    </script>

    <!-- Canonical URL -->
    <link rel="canonical" href="https://dammekynang.id.vn/masoi/quantro.html">

    <!-- Thư viện Font Awesome cho biểu tượng -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="icon" href="/logo/logoweb-dammekynang.png" type="image/png">
    <link rel="stylesheet" href="/styles.css">
    <style>
        h1 {
            font-family: 'Nosifer', Arial, sans-serif;
            font-size: 3em;
            color: #ffffff;
            margin-top: 20%;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgb(255, 25, 0),
            0 0 20px rgba(231, 76, 60, 0.5);
        }
        .container {
            width: 95%;
            max-width: 1200px;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px;
            border-radius: 10px;
            margin: 20px auto;
        }
        .reset-button, .cancel-button, .button {
            padding: 12px 20px;
            border: none;
            cursor: pointer;
            font-size: 1em;
            width: 100%;
            margin: 10px 0;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        .reset-button {
            background-color: #e74c3c;
            color: white;
        }
        .reset-button:hover {
            background-color: darkred;
        }
        .cancel-button {
            background-color: #ffffff86;
            color: white;
        }
        .cancel-button:hover {
            background-color: #333;
        }
        .button {
            background-color: #2a9d8f;
            color: white;
        }
        .button:hover {
            background-color: #076177;
        }
        .warning-button {
            background-color: orange;
            color: white;
            display: none;
            margin-top: 10px;
        }
        .player-list, .role-list {
            margin-top: 20px;
            background-color: #222222;
            color: #fff;
            padding: 15px;
            border-radius: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            padding: 10px;
            border: 1px solid #444;
            color: #ffffff;
            font-size: 1em;
        }
        .alive {
            background-color: #2ecc71;
        }
        .dead {
            background-color: #e74c3c;
        }
        .controls {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        .day-night-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .day-night-buttons button {
            flex: 1;
            min-width: 150px;
            margin: 0;
        }
        input[type="text"], select {
            padding: 10px;
            font-size: 1em;
            width: 100%;
            margin-bottom: 10px;
            color: #222;
            border: none;
            border-radius: 5px;
        }
        .actions-cell {
            display: flex;
            justify-content: center;
            gap: 5px;
        }
        .shield-button {
            background-color: #3498db;
            color: white;
        }
        .night-role-list {
            display: none;
            margin-top: 15px;
            padding: 10px;
            background-color: #333;
            border-radius: 5px;
        }
        .role-button {
            background-color: #555;
            color: white;
            padding: 8px 15px;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            margin: 5px;
        }
        .role-button.red {
            background-color: red;
        }

        .guide-button {
            margin-top: 20px;
            padding: 10px 30px;
            background-color: #e74c3c;
            color: #fff;
            border: none;
            border-radius: 50px;
            font-size: 1em;
            cursor: pointer;
            text-decoration: none;
        }
        .guide-button:hover {
            background-color: darkred;
        }

        #dayCountdownDisplay {
            background-color: #2a9d8f; /* Nền mờ màu đen với độ mờ 50% */
            color: #fff; /* Màu chữ trắng để dễ đọc trên nền mờ */
            padding: 8px; /* Tạo khoảng cách giữa văn bản và viền */
            border-radius: 5px; /* Bo tròn các góc */
            display: inline-block;
        }

        #foolVictoryModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* Màu nền mờ */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: #000000;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
        }
        .potion-button {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            margin: 0 5px;
        }
        /* Nội dung chính */
        .content {
            text-align: center;
            color: rgb(0, 0, 0);
            padding: 150px 20px 60px 450px;
        }

        .content h1 {
            font-size: 60px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.7);
        }

        .content p {
            font-size: 20px;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.5;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }
        .icon-black {
            color: #000000; /* Set icon color to black */
            margin-top: 5%;
            font-size: 40px;
        }
        

        .content p {
            font-size: 20px;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.5;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }


        @media (max-width: 7608px) {

    .content {
            text-align: 10;
            color: rgb(0, 0, 0);
            padding: 100px 50px 60px 24px;
            
        }
    
}


@media (max-width: 768px) {
    h1 {
            font-family: 'Nosifer', Arial, sans-serif;
            font-size: 3em;
            color: #ffffff;
            margin-top: 18%;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgb(255, 25, 0),
            0 0 20px rgba(231, 76, 60, 0.5);
        }
    /* Thay đổi kích thước bảng cho điện thoại */
    #playersTable {
        width: 100%; /* Đặt chiều rộng bảng là 100% để chiếm toàn bộ chiều rộng của container */
        table-layout: auto; /* Tự động điều chỉnh chiều rộng của các cột */
    }
    .player-list, .role-list {
            margin-top: 20px;
            background-color: #222222;
            padding: 15px;
            border-radius: 10px;
        }
    body {
        background-size: 100% auto; /* Đặt chiều rộng nền bằng 100% và chiều cao tự động */
        background-position: center; /* Đặt vị trí nền ở giữa */
        opacity: 1; /* Độ mờ cho logo, chỉnh lại để phù hợp */
    }
    .container {
        width: 90%; /* Giảm thêm width */
        margin: 0 auto;
        padding: 5px; /* Giảm padding */
    }
}

.initial-setup {
    text-align: center;
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
}

.player-setup {
    margin: 20px 0;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.start-game {
    background-color: #e74c3c !important;
    color: white !important;
    font-size: 1.2em !important;
    padding: 15px !important;
    margin-top: 20px !important;
}

.start-game:hover {
    background-color: #c0392b !important;
}

.players-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 15px;
    padding: 15px;
}

.player-card {
    background: rgba(71, 71, 71, 0.9);
    border-radius: 10px;
    padding: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: white;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.player-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
}

.player-info {
    display: flex;
    align-items: center;
    gap: 10px;
}

.player-avatar {
    width: 40px;
    height: 40px;
    background: #3498db;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
}

.player-name {
    font-size: 1.1em;
    font-weight: 500;
}

.player-actions {
    display: flex;
    gap: 8px;
}

.delete-btn {
    background: #e74c3c;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
    transition: background 0.2s;
}

.delete-btn:hover {
    background: #c0392b;
}

/* Media Query cho mobile */
@media (max-width: 768px) {
    .players-grid {
        grid-template-columns: 1fr;
        padding: 10px;
    }

    .player-card {
        padding: 12px;
    }
}

/* Thêm style cho giao diện chính */
#gameInterface {
    margin-top: 100px; /* Đẩy giao diện chính xuống dưới */
}

/* Điều chỉnh responsive */
@media (max-width: 768px) {
    #gameInterface {
        margin-top: 80px; /* Giảm khoảng cách trên mobile */
    }
    
    /* Điều chỉnh các nút trong giao diện chính */
    #gameInterface .controls {
        margin-top: 20px;
    }
    
    /* Điều chỉnh khoảng cách cho danh sách người chơi */
    #gameInterface .player-list {
        margin-top: 30px;
    }
}

/* Style cho grid người chơi */
.game-players-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 15px;
    padding: 15px;
    background: transparent;
    position: relative;
}

.game-player-card {
    position: relative;
    background-image: url('/masoi/images/bgr-user/mountain with.jpg');
    background-size: cover;
    background-position: center;
    border-radius: 10px;
    padding: 15px;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 2;
}

/* Thêm overlay tối cho nền */
.game-player-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.795); /* Điều chỉnh độ mờ ở đây */
    z-index: 1;
    border-radius: 10px;
}

/* Đảm bảo nội dung hiển thị trên overlay */
.game-player-name, 
.game-player-role,
.game-player-avatar,
.player-menu-btn {
    position: relative;
    z-index: 2;
}

/* Đảm bảo text dễ đọc trên nền ảnh */
.game-player-name, 
.game-player-role {
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
}

.game-player-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    margin-bottom: 10px;
    background: linear-gradient(45deg, #2a9d8f, #264653);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2em;
    overflow: hidden; /* Để ảnh không tràn ra ngoài border-radius */
}

.role-avatar {
    width: 100%;
    height: 100%;
    object-fit: cover; /* Đảm bảo ảnh không bị méo */
    transition: transform 0.3s ease;
}

.game-player-card:hover .role-avatar {
    transform: scale(1.1); /* Hiệu ứng zoom nhẹ khi hover */
}

/* Style cho trạng thái chết */
.game-player-card.chết .role-avatar {
    filter: grayscale(100%) brightness(0.7); /* Làm xám ảnh khi chết */
}

.game-player-name {
    font-size: 1.1em;
    margin-bottom: 5px;
}

.game-player-role {
    font-size: 0.9em;
    color: #2a9d8f;
}

.player-menu-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: transparent;
    border: none;
    color: white;
    cursor: pointer;
    padding: 5px;
    z-index: 3;
}

.player-menu {
    position: fixed; /* Thay đổi từ absolute sang fixed */
    background: rgba(0, 0, 0, 0.95);
    border-radius: 8px;
    padding: 8px 0;
    display: none;
    min-width: 160px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    z-index: 99999; /* Tăng z-index lên rất cao */
}

.player-menu.show {
    display: block;
}

.player-menu-item {
    padding: 8px 15px;
    color: white;
    cursor: pointer;
    transition: background 0.2s;
}

.player-menu-item:hover {
    background: rgba(42, 157, 143, 0.5);
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .game-players-grid {
        grid-template-columns: 1fr 1fr; /* Thay đổi thành 2 cột */
        gap: 3px; /* Giảm khoảng cách giữa các card */
        padding: 3px;
    }

    .game-player-card {
        width: 100%;
        padding: 3px;
        margin: 0;
        font-size: 1em; /* Giảm font size xuống */
    }

    .game-player-card img {
        width: 77px; /* Giảm avatar nhỏ hơn */
        height: 77px;
    }

    .player-name {
        font-size: 1.3em;
        margin: 1px 0;
    }

    .player-role {
        font-size: 0.7em;
        margin: 1px 0;
    }

    .player-status {
        font-size: 0.65em;
        margin: 1px 0;
    }

    .player-menu {
        width: 160px; /* Thu nhỏ menu hơn nữa */
        font-size: 1em;
    }

    .control-btn {
        padding: 4px;
        font-size: 0.7em;
    }

    .btn {
        padding: 3px 8px;
        font-size: 0.7em;
    }

    .night-role-item {
        padding: 3px;
        font-size: 0.7em;
    }

    input, select {
        font-size: 0.7em;
        padding: 2px;
    }

    .control-group {
        display: flex; /* Đổi từ grid sang flex */
        flex-direction: row; /* Đảm bảo nằm ngang */
        gap: 3px;
        width: 100%;
        margin-bottom: 3px;
    }

    .control-group:first-of-type .control-btn {
        flex: 1; /* Chia đều không gian cho 3 nút đầu */
    }

    .control-group:last-of-type .control-btn {
        flex: 1; /* Chia đều không gian cho 2 nút sau */
    }

    .control-btn {
        padding: 4px;
        font-size: 0.7em;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
        min-width: 0; /* Cho phép nút co l���i khi cần */
    }
    .control-btn i {
       font-size: 1em;
   }

    .role-dropdown-menu {
        width: 90%;
        max-width: 300px;
        left: 50%;
        transform: translateX(-50%);
    }

    #nightRoleList {
        margin: 10px 0;
        padding: 10px;
    }

    .night-role-item {
        padding: 6px;
        font-size: 0.9em;
    }

    
}

/* Thêm styles cho trạng thái người chơi */
.game-player-card.sống {
    border: 2px solid #2ecc71;
}

.game-player-card.chết {
    border: 2px solid #e74c3c;
    opacity: 0.7;
}

.game-player-card.chết .game-player-avatar {
    background: linear-gradient(45deg, #c0392b, #e74c3c);
}

/* Điều chỉnh style cho menu */
.player-menu {
    min-width: 150px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.3);
}

.player-menu-item {
    font-size: 0.9em;
}

/* Thêm hiệu ứng hover cho card */
.game-player-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

/* Animation cho menu */
.player-menu.show {
    animation: fadeIn 0.2s ease-in-out;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Style cho danh sách người chơi và ghi chú */
.player-list, .role-list {
    margin-top: 20px;
    background-color: rgba(34, 34, 34, 0.8);
    padding: 15px;
    border-radius: 10px;
}

.role-list {
    margin-top: 20px;
}

#gameLog {
    list-style: none;
    padding: 0;
    margin: 0;
    color: white;
}

#gameLog li {
    padding: 8px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .player-list, .role-list {
        margin: 10px;
        padding: 10px;
    }
}

.controls {
    margin: 20px 0;
    padding: 15px;
    background: rgba(34, 34, 34, 0.8);
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.control-group {
   display: flex; /* Dùng flex thay vì grid */
   gap: 10px;
   width: 100%;
   flex-wrap: wrap;
   justify-content: center;
   align-items: center;
}

.control-btn {
   flex: 1; /* Chia đều không gian cho mỗi nút */
   display: flex;
   align-items: center;
   justify-content: center;
   gap: 8px;
   padding: 12px;
   border: none;
   border-radius: 5px;
   color: white;
   cursor: pointer;
   transition: all 0.3s ease;
   font-size: 1em;
   white-space: nowrap; /* Ngăn text xuống dòng */ 
}


/* Style cho từng loại nút */
.control-btn.reset {
    background: #e74c3c;
}

.control-btn.reset:hover {
    background: #c0392b;
}

.control-btn.role {
    background: #2ecc71;
}

.control-btn.role:hover {
    background: #27ae60;
}

.control-btn.day {
    background: #f1c40f;
}

.control-btn.day:hover {
    background: #f39c12;
}

.control-btn.night {
    background: #34495e;
}

.control-btn.night:hover {
    background: #2c3e50;
}

.role-menu-btn {
    background: transparent;
    border: none;
    color: white;
    padding: 10px;
    cursor: pointer;
    border-radius: 5px;
    transition: background 0.3s;
}

.role-menu-btn:hover {
    background: rgba(255, 255, 255, 0.1);
}

.countdown {
    color: white;
    font-size: 1.1em;
    text-align: center;
}



/* Animation cho nút */
.control-btn:active {
    transform: scale(0.95);
}

/* Style cho cancel button */
.cancel-button {
    background: #95a5a6;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    transition: background 0.3s;
}

.cancel-button:hover {
    background: #7f8c8d;
}

/* Thêm style cho role menu */
.role-menu-container {
    position: relative;
    display: inline-block;
}

.role-dropdown-menu {
    position: absolute;
    top: 100%;
    right: 0;
    background: rgba(0, 0, 0, 0.95);
    border-radius: 10px;
    padding: 15px;
    display: none;
    z-index: 1000;
    min-width: 200px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    margin-top: 5px;
}

.role-dropdown-menu.show {
    display: block;
}

.role-list-section h4 {
    color: white;
    margin: 0 0 10px 0;
    padding-bottom: 5px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.role-items {
    max-height: 300px;
    overflow-y: auto;
}

.role-item {
    padding: 8px 15px;
    color: white;
    cursor: pointer;
    transition: background 0.2s;
    border-radius: 5px;
    margin: 2px 0;
}

.role-item:hover {
    background: rgba(42, 157, 143, 0.5);
}



.countdown-warning {
    color: #e74c3c !important;
    animation: blink 1s infinite;
}

@keyframes blink {
    0% { opacity: 1; }
    50% { opacity: 0.5; }
    100% { opacity: 1; }
}

#nightRoleList {
    background: rgba(0, 0, 0, 0.8);
    padding: 15px;
    border-radius: 10px;
    margin-top: 15px;
}

.night-role-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px;
    color: white;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.role-number {
    background: #2c3e50;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9em;
}

.role-name {
    font-size: 1.1em;
}

/* Style cho game status */
.game-status {
    text-align: center;
    margin: 10px 0;
}

.countdown {
    font-size: 2em;
    color: white;
    font-weight: bold;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
}

.warning-button {
    background: #e74c3c;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    margin-top: 10px;
    cursor: pointer;
    animation: pulse 2s infinite;
}

.night-role-list {
    background: rgba(0, 0, 0, 0.8);
    padding: 15px;
    border-radius: 10px;
    margin-top: 15px;
    color: white;
}

.night-role-list h3 {
    margin-bottom: 15px;
    color: #3498db;
}

/* Animation cho warning */
@keyframes pulse {
    0% { background-color: #e74c3c; }
    50% { background-color: #c0392b; }
    100% { background-color: #e74c3c; }
}

/* Style cho cancel button */
.cancel-button {
    background: #95a5a6;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    margin-top: 10px;
    cursor: pointer;
    transition: background 0.3s;
}

.cancel-button:hover {
    background: #7f8c8d;
}

/* Thêm style cho game status container */
.game-status-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 10px;
    width: 100%;
}

.countdown {
    font-size: 2em;
    color: white;
    font-weight: bold;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    min-height: -20; /* Thay đổi từ min-height: 40px */
    margin: 0; /* Thêm margin 0 */
    transition: all 0.3s ease; /* Thêm transition mượt mà */
}

.countdown.visible, .game-status-container.visible {
    margin-top: 10px; /* Thêm margin khi hiển thị */
    min-height: 40px; /* Thêm chiều cao khi hiển thị */
    visibility: visible;
    opacity: 1;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .game-status-container.visible {
        margin-top: 15px;
    }

    .countdown.visible {
        font-size: 1.5em;
        min-height: 30px;
    }
}

.night-roles-grid {
    display: grid;
    gap: 8px;
    padding: 10px;
    background: rgba(0, 0, 0, 0.6);
    border-radius: 8px;
}

.night-role-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 12px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.night-role-item:hover {
    background: rgba(255, 255, 255, 0.2);
}

.night-role-item.completed {
    background: rgba(46, 204, 113, 0.2);
    opacity: 0.7;
    cursor: default;
}

.role-number {
    background: #2c3e50;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9em;
}

.role-name {
    flex: 1;
    font-size: 1em;
}

.night-role-item i {
    color: #f1c40f;
}

.night-role-item.completed i {
    color: #2ecc71;
}

@media (max-width: 768px) {
    .night-roles-grid {
        gap: 5px;
    }
    
    .night-role-item {
        padding: 6px 10px;
    }
}

/* Style cho header của danh sách người chơi */
.player-list-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding: 0 10px;
}

.player-list-header h2 {
    margin: 0;
    color: white;
}

/* Style cho nút thêm người chơi */
.add-player-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px;
    background: transparent;
    border: none;
    color: white;
    cursor: pointer;
    font-size: 1.1em;
    transition: all 0.3s ease;
}

.add-player-btn:hover {
    transform: scale(1.1);
    color: #2ecc71;
}

.add-player-btn i {
    font-size: 1.2em;
}

/* Responsive */
@media (max-width: 768px) {
    .add-player-btn {
        padding: 6px;
        font-size: 1em;
    }
}

/* Thêm style cho các icon chức năng */
.role-actions {
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    gap: 8px;
    z-index: 900; /* Đảm bảo icon nằm trên các phần tử khác */
}

.role-action-btn {
    background: rgba(0, 0, 0, 0.6);
    border: none;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    z-index: 11; /* Đảm bảo button có thể click */
}

.role-action-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.1);
}

/* Thêm style cho icon bên trong button */
.role-action-btn i {
    pointer-events: none; /* Ngăn icon can thiệp vào sự kiện click */
}

.role-action-btn.disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* Màu sắc riêng cho từng loại action */
.potion-kill { background: rgba(231, 76, 60, 0.8); }
.potion-save { background: rgba(46, 204, 113, 0.8); }
.shield { background: rgba(52, 152, 219, 0.8); }
.love { background: rgba(155, 89, 182, 0.8); }

/* Thêm media query cho mobile */
@media (max-width: 768px) {
    .love-icon {
        right: auto;  /* Reset vị trí right */
        left: 85px;   /* Đặt vị trí từ bên trái */
        top: 35%;     /* Căn giữa theo chiều dọc */
    }

    .love-icon.selected {
        right: auto;  /* Reset vị trí right */
        left: 100px;   /* Giữ nguyên vị trí như love-icon */
        transform: translateY(-50%) scale(1.2);  /* Chỉ scale không dịch chuyển */
        color: #e74c3c;
    }

    /* Điều chỉnh animation cho mobile */
    @keyframes loveIconPulse {
        0% {
            transform: translateY(-50%) scale(1.2);
        }
        50% {
            transform: translateY(-50%) scale(1.4);
        }
        150% {
            transform: translateY(-50%) scale(1.2);
        }
    }

    /* Đảm bảo không bị chồng lấp với các icon khác */
    .shield-icon {
        right: 75px;  /* Điều chỉnh vị trí shield icon nếu cần */
    }
}

/* Thêm style cho nút xóa dữ liệu */
.control-btn.delete-data {
    background-color: #0f0f0f;
    color: #ff0000;
    border: 1px solid #333;
    transition: all 0.3s ease;
}

.control-btn.delete-data:hover {
    background-color: #ff0000;
    border-color: #ffffff;
    color: #ffffff;
}

.notes-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.clear-notes-btn {
    background: transparent;
    border: none;
    color: #e74c3c;
    cursor: pointer;
    padding: 8px;
    border-radius: 50%;
    transition: all 0.3s ease;
}

.clear-notes-btn:hover {
    background: rgba(231, 76, 60, 0.1);
    transform: scale(1.1);
}

.clear-notes-btn i {
    font-size: 1.5em; /* Tăng từ 1.2em lên 1.5em */
}
    </style>
    <script src="/js/menu.js"></script>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="title-container">
            <div class="menu-icon" id="menuIcon" onclick="toggleSidebar()">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="logo">
                <a href="/index.html" style="text-decoration: none; color: inherit;">
                    Đam mê Kỹ năng
                </a>
            </div>
        </div>
        <div class="header-right">
            <a href="/login.html" class="login-btn" id="loginBtn">Đăng nhập</a>
            <span id="userDisplay" style="color: white; font-weight: bold; margin-right: 15px;"></span>
            <a href="#" onclick="logout()" class="login-btn" id="logoutBtn" style="display: none;">Đăng xuất</a>
        </div>
    </header>
    <div id="sidebar-container"></div>
    <div class="container">
        <!-- Thêm phần giao diện nhập tên ban đầu -->
        <div id="initialSetup" class="initial-setup">
            <h1>Werewolf Game Master</h1>
            <div class="player-setup">
                <input type="text" id="playerName" placeholder="Nhập tên người chơi" onkeydown="handleEnter(event)">
                <button class="button" onclick="addPlayer()">Thêm Người Chơi</button>
                <button class="button start-game" onclick="startGame()" id="startGameBtn" style="display: none;">Bắt Đầu Trò Chơi</button>
            </div>
            <div class="player-list">
                <h2>Danh Sách Người Chơi</h2>
                <div id="initialPlayersGrid" class="players-grid"></div>
            </div>
        </div>

        <!-- Giao diện chính của trò chơi (ban đầu sẽ ẩn) -->
        <div id="gameInterface" style="display: none;">
            <div class="controls">
                <!-- Di chuyển nút xóa dữ liệu lên đầu -->
                <div class="control-group">
                    <button class="control-btn delete-data" onclick="confirmClearData()">
                        <i class="fas fa-trash"></i>
                        <span>Xóa Tất Cả Dữ Liệu</span>
                    </button>
                </div>

                <div class="control-group">
                    <button class="control-btn reset" onclick="startResetCountdown()">
                        <i class="fas fa-redo"></i>
                        <span>Bắt Đầu Lại</span>
                    </button>
                    <button class="control-btn role" onclick="addCustomRole()">
                        <i class="fas fa-user-plus"></i>
                        <span>Thêm Role</span>
                    </button>
                    <div class="role-menu-container">
                        <button class="role-menu-btn" onclick="toggleRoleMenu()">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                        <div id="roleMenu" class="role-dropdown-menu">
                            <div class="role-list-section">
                                <h4>Danh Sách Role</h4>
                                <div class="role-items"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <button class="control-btn day" onclick="startDayCountdown()">
                        <i class="fas fa-sun"></i>
                        <span>Bắt Đầu Ban Ngày</span>
                    </button>
                    <button class="control-btn night" onclick="startNight()">
                        <i class="fas fa-moon"></i>
                        <span>Bắt Đầu Ban Đêm</span>
                    </button>
                    
                    <div class="game-status-container">
                        <div id="countdownDisplay" class="countdown"></div>
                        <button class="warning-button" id="dayEndWarning" style="display: none;">
                            Thời Gian Ban Ngày Đã Kết Thúc
                        </button>
                    </div>
                </div>
                <button id="cancelResetButton" class="cancel-button" style="display: none;" onclick="cancelReset()">Hủy Reset</button>

                <div id="nightRoleList" class="night-role-list" style="display: none;"></div>
            </div>

            <div class="player-list">
                <div class="player-list-header">
                    <h2>Danh Sách Người Chơi</h2>
                    <button class="add-player-btn" onclick="backToInitialSetup()">
                        <i class="fas fa-user-plus"></i>
                    </button>
                </div>
                <div id="gamePlayers" class="game-players-grid"></div>
            </div>

            <div class="role-list">
                <div class="notes-header">
                    <h2>Ghi Chú Trò Chơi</h2>
                    <button class="clear-notes-btn" onclick="clearGameLogs()">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                <ul id="gameLog"></ul>
            </div>

            <div id="foolVictoryModal" style="display: none;">
                <div class="modal-content">
                    <h2>Thằng Ngố Chiến Thắng!</h2>
                    <p id="foolVictoryMessage"></p>
                    <button onclick="startResetCountdown()" class="reset-button">Bắt Đầu Lại</button>
                </div>
            </div>
        </div>
    </div>

    

    <script>
        let players = [];
        let resetTimeout;
        let resetCounter = 10;
        let dayCountdown;
        let dayCounter = 300;
        let lovePair = [];
        const nightRolesOrder = ["Thần Tình Yêu", "Bảo Vệ", "Ma Sói", "Phù Thủy", "Tiên Tri", "Bán Sói", "Thằng Ngố", "Dân làng"];

        const roleAvatars = {
            "Ma Sói": "/masoi/images/roles/wolf.png",
            "Phù Thủy": "/masoi/images/roles/witch.png",
            "Bảo Vệ": "/masoi/images/roles/guard.png",
            "Tiên Tri": "/masoi/images/roles/seer.png",
            "Thần Tình Yêu": "/masoi/images/roles/cupid.png",
            "Bán Sói": "/masoi/images/roles/wereolf.png",
            "Thằng Ngố": "/masoi/images/roles/fool.png",
            "Dân làng": "/masoi/images/roles/villager.png",
            "Chưa gán": "" // Để trống cho role chưa gán
        };

        // Mảng chứa tất cả các role trong game
        let gameRoles = [
            "Ma Sói",
            "Phù Thủy",
            "Bảo Vệ",
            "Tiên Tri",
            "Thần Tình Yêu",
            "Bán Sói",
            "Thằng Ngố",
            "Dân làng"
        ];

        // Thêm biến để lưu game logs
        let gameLogs = [];

        // Sửa lại hàm saveGameState để thêm logs
        function saveGameState() {
            const gameState = {
                players,
                lovePair,
                protectedPlayer,
                completedNightRoles: Array.from(completedNightRoles),
                hasBlackPotion,
                hasWhitePotion,
                gameLogs // Thêm logs vào state
            };
            localStorage.setItem('werewolfGameState', JSON.stringify(gameState));
        }

        // Sửa lại hàm loadGameState để đảm bảo logs được tải và hiển thị
        function loadGameState() {
            const savedState = localStorage.getItem('werewolfGameState');
            if (savedState) {
                try {
                    const gameState = JSON.parse(savedState);
                    
                    // Khôi phục trạng thái game
                    players = gameState.players || [];
                    lovePair = gameState.lovePair || [];
                    protectedPlayer = gameState.protectedPlayer || null;
                    completedNightRoles = new Set(gameState.completedNightRoles || []);
                    hasBlackPotion = gameState.hasBlackPotion ?? true;
                    hasWhitePotion = gameState.hasWhitePotion ?? true;
                    
                    // Khôi phục logs
                    gameLogs = gameState.gameLogs || [];
                    
                    // Nếu có người chơi, hiển thị giao diện game và logs
                    if (players.length > 0) {
                        document.getElementById('initialSetup').style.display = 'none';
                        document.getElementById('gameInterface').style.display = 'block';
                        renderPlayers();
                    }
                    
                    // Render logs ngay cả khi không có người chơi
                    renderGameLogs();
                    
                    console.log('Loaded game state:', gameState); // Debug log
                    console.log('Loaded logs:', gameLogs); // Debug log
                } catch (error) {
                    console.error('Error loading game state:', error);
                }
            }
        }

        function addPlayer() {
            let playerName = document.getElementById('playerName').value.trim();
            if (playerName) {
                // Kiểm tra xem tên có bị trùng không
                let nameCount = 1;
                let originalName = playerName;
                
                // Kiểm tra và thêm số nếu tên bị trùng
                while (players.some(p => p.name === playerName)) {
                    playerName = `${originalName} ${nameCount}`;
                    nameCount++;
                }

                const player = {
                    name: playerName,
                    role: "Chưa gán",
                    status: 'Sống',
                    note: "",
                    hasBlackPotion: false,
                    hasWhitePotion: false
                };
                
                players.push(player);
                document.getElementById('playerName').value = '';
                renderInitialPlayers();
                
                // Hiện nút "Bắt Đầu Trò Chơi" khi có ít nhất 1 người chơi
                if (players.length > 0) {
                    document.getElementById('startGameBtn').style.display = 'block';
                }
            }
        }

        function handleEnter(event) {
            if (event.key === "Enter") {
                addPlayer();
            }
        }

        function addRole() {
            const newRole = prompt("Nhập tên role mới:");
            if (newRole) {
                const roleSelect = document.getElementById('roles');
                const option = document.createElement("option");
                option.value = newRole;
                option.text = newRole;
                roleSelect.add(option);
                logEvent(`Vai trò mới "${newRole}" đã được thêm.`);
            }
        }

        function addCustomRole() {
            const newRole = prompt("Nhập tên role mới:");
            if (newRole && !gameRoles.includes(newRole)) {
                gameRoles.push(newRole);
                renderRoleMenu();
                logEvent(`Vai trò mới "${newRole}" đã được thêm.`);
            }
        }

        function deletePlayer(playerName) {
            players = players.filter(player => player.name !== playerName);
            renderPlayers();
            logEvent(`Người chơi ${playerName} đã bị xóa khỏi trò chơi.`);
        }


        function changeRole(playerName) {
            const player = players.find(p => p.name === playerName);
            if (!player) return;

            // Tạo menu role mới
            const roleMenu = document.createElement('div');
            roleMenu.className = 'role-selection-menu';
            roleMenu.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.95);
                padding: 20px;
                border-radius: 10px;
                z-index: 1000;
                min-width: 200px;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            `;

            // Tạo tiêu đề
            const title = document.createElement('h3');
            title.textContent = `Chọn role cho ${playerName}`;
            title.style.color = 'white';
            title.style.marginBottom = '15px';
            roleMenu.appendChild(title);

            // Thêm overlay
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 999;
            `;

            // Hàm đóng menu
            const closeMenu = () => {
                document.body.removeChild(roleMenu);
                document.body.removeChild(overlay);
            };

            overlay.onclick = closeMenu;

            // Tạo nút cho mỗi role từ danh sách gameRoles
            gameRoles.forEach(role => {
                const roleButton = document.createElement('button');
                roleButton.textContent = role;
                roleButton.className = 'role-select-button';
                roleButton.style.cssText = `
                    display: block;
                    width: 100%;
                    padding: 10px;
                    margin: 5px 0;
                    background: #2a9d8f;
                    border: none;
                    border-radius: 5px;
                    color: white;
                    cursor: pointer;
                    transition: background 0.3s;
                `;
                roleButton.onmouseover = () => roleButton.style.background = '#264653';
                roleButton.onmouseout = () => roleButton.style.background = '#2a9d8f';
                
                roleButton.onclick = () => {
                    player.role = role;
                    if (role === "Phù Thủy") {
                        player.hasBlackPotion = true;
                        player.hasWhitePotion = true;
                    }
                    closeMenu();
                    renderPlayers();
                    logEvent(`${playerName} đã được đổi role thành ${role}`);
                    saveGameState();
                };
                
                roleMenu.appendChild(roleButton);
            });

            // Nút đóng
            const closeButton = document.createElement('button');
            closeButton.textContent = 'Đóng';
            closeButton.style.cssText = `
                display: block;
                width: 100%;
                padding: 10px;
                margin-top: 10px;
                background: #e74c3c;
                border: none;
                border-radius: 5px;
                color: white;
                cursor: pointer;
                transition: background 0.3s;
            `;
            closeButton.onmouseover = () => closeButton.style.background = '#c0392b';
            closeButton.onmouseout = () => closeButton.style.background = '#e74c3c';
            closeButton.onclick = closeMenu;
            roleMenu.appendChild(closeButton);

            document.body.appendChild(overlay);
            document.body.appendChild(roleMenu);
        }

        function addLoveButtons() {
            players.forEach(player => {
                if (!document.getElementById(`${player.name}-heart`)) {
                    const heartButton = document.createElement("button");
                    heartButton.id = `${player.name}-heart`;
                    heartButton.textContent = "❤️";
                    heartButton.onclick = function() {
                        selectLovePair(player.name);
                    };
                    document.getElementById(player.name).querySelector('.actions-cell').appendChild(heartButton);
                }
            });
        }

        function selectLovePair(playerName) {
            // Chỉ cho phép chọn nếu:
            // 1. Chưa đủ 2 người trong cặp đôi
            // 2. Người chơi này chưa được chọn
            // 3. Người chơi còn sống
            const player = players.find(p => p.name === playerName);
            if (lovePair.length < 2 && 
                !lovePair.includes(playerName) && 
                player && 
                player.status === 'Sống') {
                
                lovePair.push(playerName);
                logEvent(`${playerName} đã được chọn là một nửa của cặp đôi.`);
                
                if (lovePair.length === 1) {
                    renderPlayers();
                } else if (lovePair.length === 2) {
                    logEvent(`Cặp đôi đã được chọn: ${lovePair[0]} và ${lovePair[1]}`);
                    renderPlayers();
                }
            }
        }

        function toggleStatus(playerName) {
            const player = players.find(p => p.name === playerName);
            if (player) {
                // Kiểm tra bảo vệ chỉ khi đang là ban đêm (không có đếm ngược ban ngày)
                if (player.status === 'Sống' && playerName === protectedPlayer && !dayCountdown) {
                    logEvent(`${playerName} đã được bảo vệ và không bị chết.`);
                    protectedPlayer = null; // Reset bảo vệ sau khi dùng
                } else if (player.role === 'Bán Sói' && player.status === 'Sống') {
                    player.role = 'Ma Sói';
                    logEvent(`${playerName} từ bán sói đã biến đổi thành Ma Sói và được sống lại.`);
                } else {
                    player.status = player.status === 'Sống' ? 'Chết' : 'Sống';
                    renderPlayers();
                    logEvent(`Trạng thái của ${playerName} đã thay đổi thành ${player.status}.`);
                    checkLovePairStatus(playerName);

                    if (player.role === "Thằng Ngố" && player.status === "Chết") {
                        displayFoolVictory(playerName);
                    }
                }
            }
            renderPlayers();
            saveGameState();
        }

        function checkLovePairStatus(playerName) {
            if (lovePair.includes(playerName) && players.find(p => p.name === playerName).status === 'Chết') {
                const partner = lovePair.find(name => name !== playerName);
                const partnerPlayer = players.find(p => p.name === partner);
                if (partnerPlayer && partnerPlayer.status === 'Sống') {
                    partnerPlayer.status = 'Chết';
                    renderPlayers();
                    logEvent(`${partner} đã chết theo ${playerName} vì là cặp đôi.`);
                }
            }
        }

        function renderPlayers() {
            const playersContainer = document.getElementById('gamePlayers');
            if (!playersContainer) return;
            
            playersContainer.innerHTML = '';
            
            players.forEach(player => {
                const card = document.createElement('div');
                card.className = `game-player-card ${player.status.toLowerCase()}`;
                
                if (lovePair.includes(player.name)) {
                    card.classList.add('love-pair');
                }
                
                // Tạo icon trái tim và xử lý tương tác
                let loveIcon = '';
                if (player.role === 'Thần Tình Yêu' && player.status === 'Sống') {
                    if (!isSelectingLovePair) {
                        // Nút kích hoạt chế độ chọn cặp đôi cho Thần Tình Yêu
                        loveIcon = `<div class="love-icon cupid" onclick="toggleLovePairSelection('${player.name}')">❤️</div>`;
                    } else if (!lovePair.includes(player.name)) {
                        // Cho phép Thần Tình Yêu chọn chính mình khi đang ở chế độ chọn
                        loveIcon = `<div class="love-icon clickable" onclick="selectLovePair('${player.name}')">❤️</div>`;
                    } else {
                        // Hiển thị trái tim đã chọn
                        loveIcon = '<div class="love-icon selected">❤️</div>';
                    }
                } else if (isSelectingLovePair && player.status === 'Sống' && !lovePair.includes(player.name)) {
                    // Hiển thị trái tim có thể click cho người chơi còn sống khác
                    loveIcon = `<div class="love-icon clickable" onclick="selectLovePair('${player.name}')">❤️</div>`;
                } else if (lovePair.includes(player.name)) {
                    // Hiển thị trái tim đã chọn
                    loveIcon = '<div class="love-icon selected">❤️</div>';
                }

                // Tạo phần HTML cho các action icons với onclick events
                let actionIcons = '';
                if (player.status === 'Sống') {
                    switch (player.role) {
                        case 'Phù Thủy':
                            actionIcons = `
                                <div class="role-actions">
                                    ${player.hasBlackPotion ? 
                                        `<button type="button" class="role-action-btn potion-kill" onclick="useBlackPotion('${player.name}')">
                                            <i class="fas fa-skull"></i>
                                        </button>` : ''}
                                    ${player.hasWhitePotion ? 
                                        `<button type="button" class="role-action-btn potion-save" onclick="useWhitePotion('${player.name}')">
                                            <i class="fas fa-heart"></i>
                                        </button>` : ''}
                                </div>`;
                            break;
                        case 'Bảo Vệ':
                            actionIcons = `
                                <div class="role-actions">
                                    <button type="button" class="role-action-btn shield" onclick="activateShield('${player.name}')">
                                        <i class="fas fa-shield-alt"></i>
                                    </button>
                                </div>`;
                            break;
                        case 'Thần Tình Yêu':
                            if (!lovePair.length) {
                                actionIcons = `
                                    <div class="role-actions">
                                        <button type="button" class="role-action-btn love" onclick="selectLovePair('${player.name}')">
                                            <i class="fas fa-heart"></i>
                                        </button>
                                    </div>`;
                            }
                            break;
                    }
                }

                // Tạo menu items dựa trên role
                let roleSpecificMenuItems = '';
                if (player.status === 'Sống') {
                    switch (player.role) {
                        case 'Phù Thủy':
                            if (player.hasBlackPotion) {
                                roleSpecificMenuItems += `
                                    <div class="player-menu-item" onclick="useBlackPotion('${player.name}')">
                                        <i class="fas fa-skull"></i> Dùng bình giết
                                    </div>`;
                            }
                            if (player.hasWhitePotion) {
                                roleSpecificMenuItems += `
                                    <div class="player-menu-item" onclick="useWhitePotion('${player.name}')">
                                        <i class="fas fa-heart"></i> Dùng bình cứu
                                    </div>`;
                            }
                            break;
                        case 'Bảo Vệ':
                            roleSpecificMenuItems += `
                                <div class="player-menu-item" onclick="activateShield('${player.name}')">
                                    <i class="fas fa-shield-alt"></i> Bảo vệ người chơi
                                </div>`;
                            break;
                        case 'Thần Tình Yêu':
                            if (!lovePair.length) {
                                roleSpecificMenuItems += `
                                    <div class="player-menu-item" onclick="selectLovePair('${player.name}')">
                                        <i class="fas fa-heart"></i> Chọn cặp đôi
                                    </div>`;
                            }
                            break;
                    }
                }

                const hasShield = player.name === protectedPlayer;
                console.log(`Player ${player.name} shield status:`, hasShield);
                
                // Tạo shield icon riêng biệt, tương tự như love icon
                const shieldIcon = hasShield ? 
                    `<div class="shield-icon" style="
                        position: absolute;
                        right: 60px;
                        top: 20%;
                        transform: translateY(-50%);
                        background: rgba(52, 152, 219, 0.9);
                        border-radius: 50%;
                        width: 32px;
                        height: 32px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        color: white;
                        font-size: 1.2em;
                        box-shadow: 0 2px 8px rgba(52, 152, 219, 0.5);
                        transition: all 0.3s ease;
                        animation: shieldPulse 2s infinite;
                        z-index: 3;">
                        <i class="fas fa-shield-alt"></i>
                    </div>` : '';
                
                // Thêm các icon và menu vào card
                card.innerHTML = `
                    ${actionIcons}
                    ${loveIcon}
                    ${shieldIcon}
                    <div class="game-player-avatar">
                        ${roleAvatars[player.role] ? 
                            `<img src="${roleAvatars[player.role]}" alt="${player.role}" class="role-avatar">` : 
                            player.name.charAt(0).toUpperCase()}
                    </div>
                    <div class="game-player-name">${player.name}</div>
                    <div class="game-player-role">${player.role}</div>
                    <button class="player-menu-btn" onclick="togglePlayerMenu('${player.name}')">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                    <div class="player-menu" id="menu-${player.name}">
                        ${roleSpecificMenuItems}
                        <div class="player-menu-item" onclick="toggleStatus('${player.name}')">
                            ${player.status === 'Sống' ? 'Giết' : 'Hồi sinh'}
                        </div>
                        <div class="player-menu-item" onclick="changeRole('${player.name}')">
                            Đổi Role
                        </div>
                        <div class="player-menu-item" onclick="deletePlayer('${player.name}')">
                            Xóa
                        </div>
                    </div>
                `;
                
                playersContainer.appendChild(card);
                saveGameState(); // Lưu state sau khi render
            });
        }

        function togglePlayerMenu(playerName) {
            const allMenus = document.querySelectorAll('.player-menu');
            const clickedMenu = document.getElementById(`menu-${playerName}`);
            
            // Đóng tất cả các menu khác
            allMenus.forEach(menu => {
                if (menu !== clickedMenu) {
                    menu.classList.remove('show');
                }
            });
            
            // Toggle menu được click
            if (clickedMenu) {
                clickedMenu.classList.toggle('show');
                
                // Điều chỉnh vị trí menu nếu bị tràn khỏi màn hình
                const rect = clickedMenu.getBoundingClientRect();
                if (rect.right > window.innerWidth) {
                    clickedMenu.style.right = '0';
                    clickedMenu.style.left = 'auto';
                }
            }
        }

        // Thêm event listener để đóng menu khi click ra ngoài
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.player-menu-btn') && !e.target.closest('.player-menu')) {
                document.querySelectorAll('.player-menu').forEach(menu => {
                    menu.classList.remove('show');
                });
            }
        });

        function updateNote(playerName, note) {
            const player = players.find(p => p.name === playerName);
            if (player) {
                player.note = note;
            }
        }

        function startResetCountdown() {
            const countdownDisplay = document.getElementById('countdownDisplay');
            if (!countdownDisplay) return;
            
            // Thêm class visible khi bắt đầu đếm ngược
            countdownDisplay.classList.add('visible');
            
            // Reset counter về 30 giây
            resetCounter = 30;
            
            // Hiển thị thời gian ban đầu
            countdownDisplay.textContent = `Sau ${resetCounter} giây sẽ reset từ đầu`;
            countdownDisplay.style.display = 'block';

            // Ẩn modal chiến thắng nếu có
            const foolVictoryModal = document.getElementById("foolVictoryModal");
            if (foolVictoryModal) {
                foolVictoryModal.style.display = "none";
            }

            // Dừng interval cũ nếu có
            if (resetTimeout) {
                clearInterval(resetTimeout);
            }

            // Bắt đầu đếm ngược
            resetTimeout = setInterval(() => {
                resetCounter--;
                countdownDisplay.textContent = `Sau ${resetCounter} giây sẽ reset từ đầu`;

                if (resetCounter <= 0) {
                    clearInterval(resetTimeout);
                    resetRolesAndStatus();
                    countdownDisplay.textContent = "Đã reset xong!";
                    setTimeout(() => {
                        countdownDisplay.textContent = "";
                    }, 2000);
                }
            }, 1000);

            // Log sự kiện
            logEvent("🔄 Bắt đầu đếm ngược để reset trò chơi");

            // Thêm vào đầu hàm startResetCountdown()
            const cancelButton = document.getElementById("cancelResetButton");
            if (cancelButton) {
                cancelButton.style.display = "inline-block";
            }
        }

        function cancelReset() {
            const countdownDisplay = document.getElementById('countdownDisplay');
            if (countdownDisplay) {
                // Xóa class visible khi hủy
                countdownDisplay.classList.remove('visible');
                countdownDisplay.textContent = "";
            }
            
            clearInterval(resetTimeout);
            document.getElementById("cancelResetButton").style.display = "none";
            logEvent("Đặt lại đã bị hủy.");
        }

        function resetRolesAndStatus() {
            players.forEach(player => {
                player.role = "Chưa gán";
                player.status = "Sống";
            });
            lovePair = [];
            protectedPlayer = null;
            hasBlackPotion = true; // Đặt lại bình thuốc đen
            hasWhitePotion = true; // Đặt lại bình thuốc trắng

            renderPlayers();
            document.getElementById("gameLog").innerHTML = "";
            document.getElementById("countdownDisplay").textContent = "";
            document.getElementById("cancelResetButton").style.display = "none";
            logEvent("Toàn bộ trò chơi đã đặt lại.");
        }

        function startDayCountdown() {
            const countdownDisplay = document.getElementById('countdownDisplay');
            if (!countdownDisplay) return;
            
            // Xóa bảo vệ khi bắt đầu ban ngày
            protectedPlayer = null;
            
            // Thêm class visible khi bắt đầu đếm ngược
            countdownDisplay.classList.add('visible');
            
            // Lấy thời gian từ input (đơn vị phút)
            const dayTimeInput = document.getElementById('dayTime');
            currentDayTime = dayTimeInput ? parseInt(dayTimeInput.value) : 5;
            
            // Chuyển đổi sang giây
            dayCounter = currentDayTime * 60;
            
            if (dayCountdown) {
                clearInterval(dayCountdown);
            }

            // Render lại người chơi để cập nhật hiển thị (xóa icon bảo vệ)
            renderPlayers();

            // Hàm cập nhật đếm ngược
            function updateCountdown() {
                const minutes = Math.floor(dayCounter / 60);
                const seconds = dayCounter % 60;
                countdownDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

                // Thêm cảnh báo khi còn 30 giây
                if (dayCounter <= 30) {
                    countdownDisplay.classList.add('countdown-warning');
                }

                // Kiểm tra kết thúc
                if (dayCounter <= 0) {
                    clearInterval(dayCountdown);
                    countdownDisplay.textContent = "Hết thời gian!";
                    logEvent("⏰ Thời gian ban ngày đã kết thúc");
                    return;
                }

                dayCounter--;
            }

            // Bắt đầu đếm ngược
            updateCountdown(); // Cập nhật lần đầu ngay lập tức
            dayCountdown = setInterval(updateCountdown, 1000);

            // Log sự kiện
            logEvent("🌞 Ban ngày bắt đầu - 5 phút thảo luận");
        }
        
        // Thêm biến để theo dõi các role đã được chọn
        let completedNightRoles = new Set();

        function startNight() {
            const countdownDisplay = document.getElementById('countdownDisplay');
            if (countdownDisplay) {
                // Xóa class visible khi kết thúc
                countdownDisplay.classList.remove('visible');
                countdownDisplay.textContent = "";
            }
            
            // Reset danh sách role đã hoàn thành
            completedNightRoles.clear();
            
            // Dừng đếm ngược ban ngày nếu đang chạy
            clearInterval(dayCountdown);

            // Hiển thị và cập nhật danh sách role ban đêm
            const nightRoleList = document.getElementById('nightRoleList');
            if (nightRoleList) {
                nightRoleList.innerHTML = `
                    <h3>Lượt chơi ban đêm:</h3>
                    <div class="night-roles-grid">
                        ${nightRolesOrder.map((role, index) => `
                            <div class="night-role-item ${completedNightRoles.has(role) ? 'completed' : ''}" 
                                 onclick="completeNightRole('${role}')"
                                 id="night-role-${index}">
                                <span class="role-number">${index + 1}</span>
                                <span class="role-name">${role}</span>
                                ${completedNightRoles.has(role) ? 
                                    '<i class="fas fa-check"></i>' : 
                                    '<i class="fas fa-moon"></i>'}
                            </div>
                        `).join('')}
                    </div>
                `;
                nightRoleList.style.display = 'block';
            }

            logEvent("🌙 Ban đêm bắt đầu - Các vai trò thực hiện nhiệm vụ");
        }

        function completeNightRole(role) {
            completedNightRoles.add(role);
            
            // Cập nhật giao diện
            const nightRoleList = document.getElementById('nightRoleList');
            const allRoles = document.querySelectorAll('.night-role-item');
            
            allRoles.forEach(roleElement => {
                if (roleElement.querySelector('.role-name').textContent === role) {
                    roleElement.classList.add('completed');
                    roleElement.querySelector('i').className = 'fas fa-check';
                }
            });

            // Log sự kiện
            logEvent(`✓ ${role} đã hoàn thành lượt`);

            // Kiểm tra nếu tất cả role đã hoàn thành
            if (completedNightRoles.size === nightRolesOrder.length) {
                setTimeout(() => {
                    nightRoleList.style.display = 'none';
                    logEvent("🌅 Tất cả vai trò đã hoàn thành - Ban đêm kết thúc");
                }, 1000);
            }
        }

        function addCustomRole() {
            const newRole = prompt("Nhập tên role mới:");
            if (newRole && !nightRolesOrder.includes(newRole)) {
                nightRolesOrder.push(newRole);
                gameRoles.push(newRole);
                renderRoleMenu();
                logEvent(`➕ Đã thêm role mới: ${newRole}`);
            }
        }

        // Sửa lại hàm logEvent để lưu log vào array và localStorage
        function logEvent(event) {
            const gameLog = document.getElementById('gameLog');
            if (!gameLog) {
                console.error("Không tìm thấy element gameLog");
                return;
            }

            // Tạo log entry với timestamp
            const now = new Date();
            const time = now.toLocaleTimeString('vi-VN', { 
                hour: '2-digit', 
                minute: '2-digit',
                second: '2-digit'
            });
            
            const logEntry = {
                time,
                event,
                timestamp: now.getTime() // Lưu timestamp để sắp xếp
            };
            
            // Thêm vào array logs
            gameLogs.unshift(logEntry); // Thêm vào đầu array
            
            // Render log mới
            renderGameLogs();
            
            // Lưu state
            saveGameState();
        }

        // Thêm hàm render game logs
        function renderGameLogs() {
            const gameLog = document.getElementById('gameLog');
            if (!gameLog) return;
            
            gameLog.innerHTML = '';
            
            gameLogs.forEach(log => {
                const li = document.createElement('li');
                li.innerHTML = `<span class="log-time">[${log.time}]</span> ${log.event}`;
                li.style.animation = 'newLog 0.5s ease-out';
                gameLog.appendChild(li);
            });
        }

        // Thêm hàm xóa logs
        function clearGameLogs() {
            if (confirm('Bạn có chắc chắn muốn xóa tất cả ghi chú?')) {
                gameLogs = [];
                document.getElementById('gameLog').innerHTML = '';
                saveGameState(); // Lưu trạng thái mới vào localStorage
            }
        }

        // Sửa lại hàm confirmClearData để xóa cả logs
        function confirmClearData() {
            if (confirm('Bạn có chắc muốn xóa tất cả dữ liệu trò chơi? Hành động này không thể hoàn tác.')) {
                players = [];
                lovePair = [];
                protectedPlayer = null;
                completedNightRoles.clear();
                hasBlackPotion = true;
                hasWhitePotion = true;
                gameLogs = []; // Xóa logs
                
                renderPlayers();
                renderGameLogs();
                saveGameState();
                
                // Chuyển về màn hình setup
                document.getElementById('initialSetup').style.display = 'block';
                document.getElementById('gameInterface').style.display = 'none';
                
                logEvent("Đã xóa toàn bộ dữ liệu trò chơi");
            }
        }

        // Thêm style
        const dayNightStyle = document.createElement('style');
        dayNightStyle.textContent = `
            #countdownDisplay {
                font-size: 2em;
                color: white;
                text-align: center;
                margin: 10px 0;
                font-weight: bold;
                text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            }

            .countdown-warning {
                color: #e74c3c !important;
                animation: blink 1s infinite;
            }

            @keyframes blink {
                0% { opacity: 1; }
                50% { opacity: 0.5; }
                100% { opacity: 1; }
            }

            .log-time {
                color: #95a5a6;
                margin-right: 8px;
            }

            @keyframes newLog {
                from {
                    opacity: 0;
                    transform: translateY(-10px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            #gameLog li {
                padding: 8px;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                transition: background-color 0.3s;
            }

            #gameLog li:hover {
                background-color: rgba(255, 255, 255, 0.05);
            }
        `;
        document.head.appendChild(dayNightStyle);

        // Đảm bảo HTML có các elements cần thiết
        document.addEventListener('DOMContentLoaded', () => {
            // Kiểm tra các elements cần thiết
            const requiredElements = ['countdownDisplay', 'gameLog', 'nightRoleList'];
            requiredElements.forEach(id => {
                if (!document.getElementById(id)) {
                    console.error(`Thiếu element có id: ${id}`);
                }
            });
        });
    



    let protectedPlayer = null; // Biến để lưu người chơi được bảo vệ

    function renderPlayers() {
        const playersContainer = document.getElementById('gamePlayers');
        if (!playersContainer) return;
        
        playersContainer.innerHTML = ''; // Xóa nội dung cũ
        
        players.forEach(player => {
            const card = document.createElement('div');
            card.className = `game-player-card ${player.status.toLowerCase()}`;
            
            if (lovePair.includes(player.name)) {
                card.classList.add('love-pair');
            }
            
            // Tạo icon trái tim và xử lý tương tác
            let loveIcon = '';
            if (player.role === 'Thần Tình Yêu' && player.status === 'Sống') {
                if (!isSelectingLovePair) {
                    // Nút kích hoạt chế độ chọn cặp đôi cho Thần Tình Yêu
                    loveIcon = `<div class="love-icon cupid" onclick="toggleLovePairSelection('${player.name}')">❤️</div>`;
                } else if (!lovePair.includes(player.name)) {
                    // Cho phép Thần Tình Yêu chọn chính mình khi đang ở chế độ chọn
                    loveIcon = `<div class="love-icon clickable" onclick="selectLovePair('${player.name}')">❤️</div>`;
                } else {
                    // Hiển thị trái tim đã chọn
                    loveIcon = '<div class="love-icon selected">❤️</div>';
                }
            } else if (isSelectingLovePair && player.status === 'Sống' && !lovePair.includes(player.name)) {
                // Hiển thị trái tim có thể click cho người chơi còn sống khác
                loveIcon = `<div class="love-icon clickable" onclick="selectLovePair('${player.name}')">❤️</div>`;
            } else if (lovePair.includes(player.name)) {
                // Hiển thị trái tim đã chọn
                loveIcon = '<div class="love-icon selected">❤️</div>';
            }

            // Tạo phần HTML cho các action icons với onclick events
            let actionIcons = '';
            if (player.status === 'Sống') {
                switch (player.role) {
                    case 'Phù Thủy':
                        actionIcons = `
                            <div class="role-actions">
                                ${player.hasBlackPotion ? 
                                    `<button type="button" class="role-action-btn potion-kill" onclick="useBlackPotion('${player.name}')">
                                        <i class="fas fa-skull"></i>
                                    </button>` : ''}
                                ${player.hasWhitePotion ? 
                                    `<button type="button" class="role-action-btn potion-save" onclick="useWhitePotion('${player.name}')">
                                        <i class="fas fa-heart"></i>
                                    </button>` : ''}
                            </div>`;
                        break;
                    case 'Bảo Vệ':
                        actionIcons = `
                            <div class="role-actions">
                                <button type="button" class="role-action-btn shield" onclick="activateShield('${player.name}')">
                                    <i class="fas fa-shield-alt"></i>
                                </button>
                            </div>`;
                        break;
                    case 'Thần Tình Yêu':
                        if (!lovePair.length) {
                            actionIcons = `
                                <div class="role-actions">
                                    <button type="button" class="role-action-btn love" onclick="selectLovePair('${player.name}')">
                                        <i class="fas fa-heart"></i>
                                    </button>
                                </div>`;
                        }
                        break;
                }
            }

            // Tạo menu items dựa trên role
            let roleSpecificMenuItems = '';
            if (player.status === 'Sống') {
                switch (player.role) {
                    case 'Phù Thủy':
                        if (player.hasBlackPotion) {
                            roleSpecificMenuItems += `
                                <div class="player-menu-item" onclick="useBlackPotion('${player.name}')">
                                    <i class="fas fa-skull"></i> Dùng bình giết
                                </div>`;
                        }
                        if (player.hasWhitePotion) {
                            roleSpecificMenuItems += `
                                <div class="player-menu-item" onclick="useWhitePotion('${player.name}')">
                                    <i class="fas fa-heart"></i> Dùng bình cứu
                                </div>`;
                        }
                        break;
                    case 'Bảo Vệ':
                        roleSpecificMenuItems += `
                            <div class="player-menu-item" onclick="activateShield('${player.name}')">
                                <i class="fas fa-shield-alt"></i> Bảo vệ người chơi
                            </div>`;
                        break;
                    case 'Thần Tình Yêu':
                        if (!lovePair.length) {
                            roleSpecificMenuItems += `
                                <div class="player-menu-item" onclick="selectLovePair('${player.name}')">
                                    <i class="fas fa-heart"></i> Chọn cặp đôi
                                </div>`;
                        }
                        break;
                }
            }

            const hasShield = player.name === protectedPlayer;
            console.log(`Player ${player.name} shield status:`, hasShield);
            
            // Tạo shield icon riêng biệt, tương tự như love icon
            const shieldIcon = hasShield ? 
                `<div class="shield-icon" style="
                    position: absolute;
                    right: 60px;
                    top: 20%;
                    transform: translateY(-50%);
                    background: rgba(52, 152, 219, 0.9);
                    border-radius: 50%;
                    width: 42px;
                    height: 42px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 1.2em;
                    box-shadow: 0 2px 8px rgba(52, 152, 219, 0.5);
                    transition: all 0.3s ease;
                    animation: shieldPulse 2s infinite;
                    z-index: 3;">
                    <i class="fas fa-shield-alt"></i>
                </div>` : '';
            
            // Thêm các icon và menu vào card
            card.innerHTML = `
                ${actionIcons}
                ${loveIcon}
                ${shieldIcon}
                <div class="game-player-avatar">
                    ${roleAvatars[player.role] ? 
                        `<img src="${roleAvatars[player.role]}" alt="${player.role}" class="role-avatar">` : 
                        player.name.charAt(0).toUpperCase()}
                </div>
                <div class="game-player-name">${player.name}</div>
                <div class="game-player-role">${player.role}</div>
                <button class="player-menu-btn" onclick="togglePlayerMenu('${player.name}')">
                    <i class="fas fa-ellipsis-v"></i>
                </button>
                <div class="player-menu" id="menu-${player.name}">
                    ${roleSpecificMenuItems}
                    <div class="player-menu-item" onclick="toggleStatus('${player.name}')">
                        ${player.status === 'Sống' ? 'Giết' : 'Hồi sinh'}
                    </div>
                    <div class="player-menu-item" onclick="changeRole('${player.name}')">
                        Đổi Role
                    </div>
                    <div class="player-menu-item" onclick="deletePlayer('${player.name}')">
                        Xóa
                    </div>
                </div>
            `;
            
            playersContainer.appendChild(card);
            saveGameState(); // Lưu state sau khi render
        });
    }

    let hasBlackPotion = true; // Kiểm soát trạng thái bình thuốc đen
    let hasWhitePotion = true; // Kiểm soát trạng thái bình thuốc trắng

    function useBlackPotion(witchName) {
        const witchPlayer = players.find(p => p.name === witchName);
        if (!witchPlayer || !witchPlayer.hasBlackPotion) return; // Nếu đã dùng bình thuốc đen thì thoát

        const targetName = prompt("Nhập tên người chơi bạn muốn giết:");
        const targetPlayer = players.find(p => p.name === targetName && p.status === 'Sống');
        
        if (targetPlayer) {
            targetPlayer.status = 'Chết';
            witchPlayer.hasBlackPotion = false; // Bình thuốc đen không còn sau khi dùng
            renderPlayers();
            logEvent(`Phù Thủy ${witchName} đã giết ${targetName} bằng bình thuốc đen.`);
            hasBlackPotion = false; // Bình thuốc đen không còn sau khi dùng
            saveGameState();
        } else {
            alert("Người chơi không hợp lệ hoặc đã chết.");
        }
    }

    function useWhitePotion(witchName) {
        const witchPlayer = players.find(p => p.name === witchName);
        if (!witchPlayer || !witchPlayer.hasWhitePotion) return; // Nếu đã dùng bình thuốc trắng thì thoát
        const targetName = prompt("Nhập tên người chơi bạn muốn hồi sinh:");

        const targetPlayer = players.find(p => p.name === targetName && p.status === 'Chết');
        if (targetPlayer) {
            targetPlayer.status = 'Sống';
            witchPlayer.hasWhitePotion = false; // Bình thuốc trắng không còn sau khi dùng
            renderPlayers();
            logEvent(`Phù Thủy ${witchName} đã hồi sinh ${targetName} bằng bình thuốc trắng.`);
            hasWhitePotion = false; // Bình thuốc trắng không còn sau khi dùng
            saveGameState();
        } else {
            alert("Người chơi không hợp lệ hoặc đang sống.");
        }
    }


    function activateShield() {
        const selectedPlayer = prompt("Nhập tên người chơi mà Bảo Vệ muốn bảo vệ:");
        const player = players.find(p => p.name === selectedPlayer);
        
        if (player && player.status === 'Sống') {
            protectedPlayer = selectedPlayer;
            
            // Thêm thuộc tính isProtected cho player
            player.isProtected = true;
            
            logEvent(`${protectedPlayer} đã được bảo vệ bởi Bảo Vệ.`);
            renderPlayers();
            saveGameState();
            
            // Debug logs
            console.log("Protected player:", protectedPlayer);
            console.log("Player object:", player);
        } else {
            alert("Người chơi không hợp lệ hoặc không tồn tại.");
        }
    }

        function toggleStatus(playerName) {
            const player = players.find(p => p.name === playerName);
            if (player) {
                // Kiểm tra bảo vệ chỉ khi đang là ban đêm (không có đếm ngược ban ngày)
                if (player.status === 'Sống' && playerName === protectedPlayer && !dayCountdown) {
                    logEvent(`${playerName} đã được bảo vệ và không bị chết.`);
                    protectedPlayer = null; // Reset bảo vệ sau khi dùng
                } else if (player.role === 'Bán Sói' && player.status === 'Sống') {
                    player.role = 'Ma Sói';
                    logEvent(`${playerName} từ bán sói đã biến đổi thành Ma Sói và được sống lại.`);
                } else {
                    player.status = player.status === 'Sống' ? 'Chết' : 'Sống';
                    renderPlayers();
                    logEvent(`Trạng thái của ${playerName} đã thay đổi thành ${player.status}.`);
                    checkLovePairStatus(playerName);

                    // Kiểm tra nếu vai trò là "Thằng Ngố" và người chơi bị giết
                    if (player.role === "Thằng Ngố" && player.status === "Chết") {
                        displayFoolVictory(playerName);
                    }
                }
            }
            renderPlayers(); // Cập nhật lại danh sách người chơi để hiển thị thay đổi
            saveGameState();
        }

        function startDayCountdown() {
            const countdownDisplay = document.getElementById('countdownDisplay');
            if (!countdownDisplay) return;
            
            // Xóa bảo vệ khi bắt đầu ban ngày
            protectedPlayer = null;
            
            // Thêm class visible khi bắt đầu đếm ngược
            countdownDisplay.classList.add('visible');
            
            // Lấy thời gian từ input (đơn vị phút)
            const dayTimeInput = document.getElementById('dayTime');
            currentDayTime = dayTimeInput ? parseInt(dayTimeInput.value) : 5;
            
            // Chuyển đổi sang giây
            dayCounter = currentDayTime * 60;
            
            if (dayCountdown) {
                clearInterval(dayCountdown);
            }

            // Render lại người chơi để cập nhật hiển thị (xóa icon bảo vệ)
            renderPlayers();

            // Hàm cập nhật đếm ngược
            function updateCountdown() {
                const minutes = Math.floor(dayCounter / 60);
                const seconds = dayCounter % 60;
                countdownDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

                // Thêm cảnh báo khi còn 30 giây
                if (dayCounter <= 30) {
                    countdownDisplay.classList.add('countdown-warning');
                }

                // Kiểm tra kết thúc
                if (dayCounter <= 0) {
                    clearInterval(dayCountdown);
                    countdownDisplay.textContent = "Hết thời gian!";
                    logEvent("⏰ Thời gian ban ngày đã kết thúc");
                    return;
                }

                dayCounter--;
            }

            // Bắt đầu đếm ngược
            updateCountdown(); // Cập nhật lần đầu ngay lập tức
            dayCountdown = setInterval(updateCountdown, 1000);

            // Log sự kiện
            logEvent("🌞 Ban ngày bắt đầu - 5 phút thảo luận");
        }

        function toggleStatus(playerName) {
            const player = players.find(p => p.name === playerName);
            if (player) {
                // Kiểm tra bảo vệ chỉ khi đang là ban đêm (không có đếm ngược ban ngày)
                if (player.status === 'Sống' && playerName === protectedPlayer && !dayCountdown) {
                    logEvent(`${playerName} đã được bảo vệ và không bị chết.`);
                    protectedPlayer = null; // Reset bảo vệ sau khi dùng
                } else if (player.role === 'Bán Sói' && player.status === 'Sống') {
                    player.role = 'Ma Sói';
                    logEvent(`${playerName} từ bán sói đã biến đổi thành Ma Sói và được sống lại.`);
                } else {
                    player.status = player.status === 'Sống' ? 'Chết' : 'Sống';
                    renderPlayers();
                    logEvent(`Trạng thái của ${playerName} đã thay đổi thành ${player.status}.`);
                    checkLovePairStatus(playerName);

                    // Kiểm tra nếu vai trò là "Thằng Ngố" và người chơi bị giết
                    if (player.role === "Thằng Ngố" && player.status === "Chết") {
                        displayFoolVictory(playerName);
                    }
                }
            }
            renderPlayers(); // Cập nhật lại danh sách người chơi để hiển thị thay đổi
            saveGameState();
        }

        // Hàm hiển thị thông báo "Thằng Ngố Chiến Thắng"
        function displayFoolVictory(playerName) {
            document.getElementById("foolVictoryMessage").textContent = `Người chơi ${playerName} (Thằng Ngố) đã chiến thắng!`;
            document.getElementById("foolVictoryModal").style.display = "flex";
        }

        function renderInitialPlayers() {
            const grid = document.getElementById('initialPlayersGrid');
            if (!grid) return;
            
            grid.innerHTML = '';

            players.forEach(player => {
                const playerCard = document.createElement('div');
                playerCard.className = 'player-card';
                
                const initial = player.name.charAt(0).toUpperCase();
                
                playerCard.innerHTML = `
                    <div class="player-info">
                        <div class="player-avatar">${initial}</div>
                        <span class="player-name">${player.name}</span>
                    </div>
                    <div class="player-actions">
                        <button onclick="deleteInitialPlayer('${player.name}')" class="delete-btn">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                grid.appendChild(playerCard);
            });
        }

        function deleteInitialPlayer(playerName) {
            players = players.filter(player => player.name !== playerName);
            renderInitialPlayers();
            
            // Ẩn nút "Bắt Đầu Trò Chơi" nếu không còn người chơi nào
            if (players.length === 0) {
                document.getElementById('startGameBtn').style.display = 'none';
            }
            saveGameState();
        }

        function startGame() {
            if (players.length > 0) {
                document.getElementById('initialSetup').style.display = 'none';
                document.getElementById('gameInterface').style.display = 'block';
                renderPlayers(); // Render danh sách người chơi trong giao diện chính
                logEvent("Trò chơi đã bắt đầu!");
                saveGameState(); // Lưu state khi bắt đầu game
            } else {
                alert("Vui lòng thêm ít nhất một người chơi trước khi bắt đầu!");
            }
        }

        function logEvent(event) {
            const gameLog = document.getElementById('gameLog');
            if (gameLog) {
                const logEntry = document.createElement('li');
                logEntry.textContent = event;
                gameLog.insertBefore(logEntry, gameLog.firstChild); // Thêm event mới lên đầu danh sách
            }
        }

        function toggleRoleMenu() {
            const menu = document.getElementById('roleMenu');
            menu.classList.toggle('show');
            
            // Đóng menu khi click ra ngoài
            document.addEventListener('click', function closeMenu(e) {
                if (!e.target.closest('.role-menu-btn') && !e.target.closest('.role-dropdown-menu')) {
                    menu.classList.remove('show');
                    document.removeEventListener('click', closeMenu);
                }
            });
        }

        function addNewRole() {
            const newRole = prompt("Nhập tên role mới:");
            if (newRole) {
                const roleSelect = document.getElementById('roles');
                const option = document.createElement("option");
                option.value = newRole;
                option.text = newRole;
                roleSelect.add(option);
                logEvent(`Vai trò mới "${newRole}" đã được thêm.`);
            }
        }

        function editRoles() {
            // Hiện modal để chỉnh sửa danh sách role
            // Có thể thêm code ở đây
        }

        function deleteRole() {
            const roleSelect = document.getElementById('roles');
            const selectedRole = roleSelect.value;
            
            if (selectedRole !== "Role mặc định") {
                if (confirm(`Bạn có chắc muốn xóa role "${selectedRole}"?`)) {
                    roleSelect.remove(roleSelect.selectedIndex);
                    logEvent(`Vai trò "${selectedRole}" đã bị xóa.`);
                }
            } else {
                alert("Không thể xóa Role mặc định!");
            }
        }

        function renderRoleMenu() {
            const roleItems = document.querySelector('.role-items');
            if (!roleItems) return;
            
            roleItems.innerHTML = ''; // Xóa danh sách cũ
            
            gameRoles.forEach(role => {
                const roleItem = document.createElement('div');
                roleItem.className = 'role-item';
                roleItem.textContent = role;
                roleItems.appendChild(roleItem);
            });
        }

    // Khởi tạo menu role khi trang được load
    document.addEventListener('DOMContentLoaded', () => {
        renderRoleMenu();
    });

    // Khởi tạo các elements cần thiết
    function initializeGameElements() {
        // Tạo container cho game status nếu chưa tồn tại
        let statusContainer = document.querySelector('.game-status-container');
        if (!statusContainer) {
            statusContainer = document.createElement('div');
            statusContainer.className = 'game-status-container';
            
            // Tìm vị trí để chèn container
            const controlGroup = document.querySelector('.control-group');
            if (controlGroup) {
                controlGroup.appendChild(statusContainer);
            }
        }

        // Tạo countdown display nếu chưa tồn tại
        let countdownDisplay = document.getElementById('countdownDisplay');
        if (!countdownDisplay) {
            countdownDisplay = document.createElement('div');
            countdownDisplay.id = 'countdownDisplay';
            countdownDisplay.className = 'countdown';
            statusContainer.appendChild(countdownDisplay);
        }

        // Tạo warning button nếu chưa tồn tại
        let warningBtn = document.getElementById('dayEndWarning');
        if (!warningBtn) {
            warningBtn = document.createElement('button');
            warningBtn.id = 'dayEndWarning';
            warningBtn.className = 'warning-button';
            warningBtn.style.display = 'none';
            warningBtn.textContent = 'Thời Gian Ban Ngày Đã Kết Thúc';
            statusContainer.appendChild(warningBtn);
        }

        // Tạo night role list nếu chưa tồn tại
        let nightRoleList = document.getElementById('nightRoleList');
        if (!nightRoleList) {
            nightRoleList = document.createElement('div');
            nightRoleList.id = 'nightRoleList';
            nightRoleList.className = 'night-role-list';
            nightRoleList.style.display = 'none';
            document.querySelector('.controls').appendChild(nightRoleList);
        }
    }

    // Khởi tạo khi trang được load
    document.addEventListener('DOMContentLoaded', initializeGameElements);

    // Sửa lại hàm startDayCountdown
    function startDayCountdown() {
        // Đảm bảo các elements tồn tại
        initializeGameElements();

        // Reset các trạng thái
        const nightRoleList = document.getElementById('nightRoleList');
        if (nightRoleList) {
            nightRoleList.style.display = 'none';
        }

        // Dừng bộ đếm cũ nếu có
        if (dayCountdown) {
            clearInterval(dayCountdown);
        }

        // Thiết lập thời gian ban đầu (5 phút)
        dayCounter = 300;

        const countdownDisplay = document.getElementById('countdownDisplay');
        
        // Hiển thị thời gian ban đầu
        if (countdownDisplay) {
            countdownDisplay.textContent = "5:00";
            countdownDisplay.style.display = 'block';
            countdownDisplay.classList.remove('countdown-warning');
        }

        // Bắt đầu đếm ngược
        dayCountdown = setInterval(() => {
            if (dayCounter >= 0) {
                const minutes = Math.floor(dayCounter / 60);
                const seconds = dayCounter % 60;
                if (countdownDisplay) {
                    countdownDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                    
                    // Thêm cảnh báo khi còn 30 giây
                    if (dayCounter <= 30) {
                        countdownDisplay.classList.add('countdown-warning');
                    }
                }
                dayCounter--;
            } else {
                clearInterval(dayCountdown);
                if (countdownDisplay) {
                    countdownDisplay.textContent = "Hết thời gian!";
                }
                logEvent("⏰ Thời gian ban ngày đã kết thúc");
            }
        }, 1000);

        // Log sự kiện bắt đầu
        logEvent("🌞 Ban ngày bắt đầu - 5 phút thảo luận");
    }

    function backToInitialSetup() {
        // Lưu trạng thái game hiện tại
        const currentGameState = {
            players: players,
            // Thêm các trạng thái khác nếu cần
        };
        
        // Ẩn giao diện game
        document.getElementById('gameInterface').style.display = 'none';
        
        // Hiện giao diện setup ban đầu
        const initialSetup = document.getElementById('initialSetup');
        initialSetup.style.display = 'block';
        
        // Clear input field
        document.getElementById('playerName').value = '';
        
        // Render lại danh sách người chơi ban đầu
        renderInitialPlayers();
    }

    // Thêm animation khi chuyển đổi giao diện
    const transitionStyle = document.createElement('style');
    transitionStyle.textContent = `
        #initialSetup, #gameInterface {
            transition: opacity 0.3s ease;
        }
        
        #initialSetup.fade-out, #gameInterface.fade-out {
            opacity: 0;
        }
        
        #initialSetup.fade-in, #gameInterface.fade-in {
            opacity: 1;
        }
    `;
    document.head.appendChild(transitionStyle);

    // Thêm styles mới
    const loveStyles = document.createElement('style');
    loveStyles.textContent = `
        .role-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .game-player-avatar {
            position: relative;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, #2a9d8f, #264653);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
        }
        
        .love-icon {
            position: absolute;
            font-size: 1.5em;
            z-index: 900;
            transition: all 0.3s ease;
        }
        
        .love-icon.cupid,
        .love-icon.clickable {
            top: 10px;
            left: 10px;
            opacity: 0.7;
            cursor: pointer;
        }
        
        .love-icon.selected {
            position: absolute;
            right: 75px;
            top: 25%;
            transform: translateY(-50%);
            opacity: 1;
            color: #ff69b4;
            animation: heartbeat 1.5s infinite;
        }
        
        .love-icon.cupid:hover,
        .love-icon.clickable:hover {
            opacity: 0.8;
            transform: scale(1.1);
        }
        
        .love-pair {
            border: 2px solid #ff69b4;
            box-shadow: 0 0 10px rgba(255, 105, 180, 0.5);
        }
        
        @keyframes heartbeat {
            0% { transform: translateY(-50%) scale(1); }
            50% { transform: translateY(-50%) scale(1.2); }
            100% { transform: translateY(-50%) scale(1); }
        }
        
        @keyframes pulse {
            0% { color: #ff69b4; }
            50% { color: #ff1493; }
            100% { color: #ff69b4; }
        }
    `;
    document.head.appendChild(loveStyles);

    // Thêm biến để theo dõi trạng thái chọn cặp đôi
    let isSelectingLovePair = false;

    function toggleLovePairSelection(playerName) {
        const player = players.find(p => p.name === playerName);
        if (player && player.role === 'Thần Tình Yêu' && player.status === 'Sống') {
            isSelectingLovePair = !isSelectingLovePair;
            if (isSelectingLovePair) {
                logEvent("Thần Tình Yêu đang chọn cặp đôi...");
            } else {
                logEvent("Hủy chọn cặp đôi");
                lovePair = []; // Reset lựa chọn nếu hủy
            }
            renderPlayers();
        }
    }

    function selectLovePair(playerName) {
        if (!isSelectingLovePair) return; // Chỉ cho phép chọn khi đang ở chế độ chọn cặp đôi

        const player = players.find(p => p.name === playerName);
        if (lovePair.length < 2 && 
            !lovePair.includes(playerName) && 
            player && 
            player.status === 'Sống') {
            
            lovePair.push(playerName);
            logEvent(`${playerName} đã được chọn làm một nửa của cặp đôi.`);
            
            if (lovePair.length === 2) {
                logEvent(`Cặp đôi đã được chọn: ${lovePair[0]} và ${lovePair[1]}`);
                isSelectingLovePair = false; // Tự động tắt chế độ chọn sau khi hoàn thành
            }
            renderPlayers();
        }
    }

    // Thêm animation cho shield
    const shieldStyle = document.createElement('style');
    shieldStyle.textContent = `
        @keyframes shieldPulse {
            0% {
                box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.4);
                transform: translateY(-50%) scale(1);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(52, 152, 219, 0);
                transform: translateY(-50%) scale(1.1);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(52, 152, 219, 0);
                transform: translateY(-50%) scale(1);
            }
        }

        .shield-icon:hover {
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.7);
        }
    `;
    document.head.appendChild(shieldStyle);

    // Thêm vào phần initial setup HTML
    function renderInitialSetup() {
        const initialSetup = document.getElementById('initialSetup');
        if (!initialSetup) return;

        // Thêm input điều chỉnh thời gian với thiết kế mới
        const timeSetupHTML = `
            <div class="time-setup" style="
                margin: 25px 0;
                padding: 15px 20px;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 10px;
                display: flex;
                align-items: center;
                gap: 15px;
                color: white;
                backdrop-filter: blur(5px);
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                transition: all 0.3s ease;">
            <div style="
                display: flex;
                align-items: center;
                gap: 10px;">
                <i class="fas fa-clock" style="
                    font-size: 1.2em;
                    color: #3498db;"></i>
                <label for="dayTime" style="
                    font-weight: 500;
                    font-size: 1.1em;">Thời gian ban ngày:</label>
            </div>
            <div style="
                display: flex;
                align-items: center;
                gap: 8px;">
                <input type="number" 
                    id="dayTime" 
                    min="1" 
                    max="60" 
                    value="5"
                    style="
                        width: 60px;
                        padding: 8px;
                        border-radius: 6px;
                        border: 2px solid rgba(52, 152, 219, 0.3);
                        text-align: center;
                        background: rgba(255, 255, 255, 0.9);
                        font-size: 1em;
                        font-weight: 500;
                        color: #2c3e50;
                        transition: all 0.3s ease;
                        outline: none;">
                <span style="
                    font-size: 0.9em;
                    opacity: 0.8;">phút</span>
            </div>
        </div>
    `;

        // Thêm style cho input focus và hover
        const timeSetupStyle = document.createElement('style');
        timeSetupStyle.textContent = `
            #dayTime:hover {
                border-color: rgba(52, 152, 219, 0.5);
                box-shadow: 0 0 5px rgba(52, 152, 219, 0.2);
            }
            
            #dayTime:focus {
                border-color: #3498db;
                box-shadow: 0 0 8px rgba(52, 152, 219, 0.4);
            }
            
            .time-setup:hover {
                background: rgba(255, 255, 255, 0.15);
                transform: translateY(-1px);
            }
            
            /* Tùy chỉnh arrows của input number */
            #dayTime::-webkit-inner-spin-button,
            #dayTime::-webkit-outer-spin-button {
                opacity: 1;
                height: 20px;
                cursor: pointer;
            }
            
            @media (max-width: 480px) {
                .time-setup {
                    flex-direction: column;
                    align-items: flex-start;
                    gap: 10px;
                }
            }
        `;
        document.head.appendChild(timeSetupStyle);

        // Chèn vào trước nút Start Game
        const startGameBtn = document.getElementById('startGameBtn');
        if (startGameBtn) {
            startGameBtn.insertAdjacentHTML('beforebegin', timeSetupHTML);
        }

        // Event listener vẫn giữ nguyên
        const dayTimeInput = document.getElementById('dayTime');
        if (dayTimeInput) {
            dayTimeInput.addEventListener('change', function() {
                // Nếu đang trong quá trình đếm ngược, cập nhật lại
                if (dayCountdown) {
                    clearInterval(dayCountdown);
                    startDayCountdown();
                }
            });
        }
    }

    // Sửa lại hàm startDayCountdown để lưu giá trị thời gian hiện tại
    let currentDayTime = 5; // Giá trị mặc định

    function startDayCountdown() {
        const countdownDisplay = document.getElementById('countdownDisplay');
        if (!countdownDisplay) return;
        
        // Xóa bảo vệ khi bắt đầu ban ngày
        protectedPlayer = null;
        
        // Thêm class visible khi bắt đầu đếm ngược
        countdownDisplay.classList.add('visible');
        
        // Lấy thời gian từ input (đơn vị phút)
        const dayTimeInput = document.getElementById('dayTime');
        currentDayTime = dayTimeInput ? parseInt(dayTimeInput.value) : 5;
        
        // Chuyển đổi sang giây
        dayCounter = currentDayTime * 60;
        
        if (dayCountdown) {
            clearInterval(dayCountdown);
        }

        // Render lại người chơi để cập nhật hiển thị (xóa icon bảo vệ)
        renderPlayers();

        // Hàm cập nhật đếm ngược
        function updateCountdown() {
            const minutes = Math.floor(dayCounter / 60);
            const seconds = dayCounter % 60;
            countdownDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

            // Thêm cảnh báo khi còn 30 giây
            if (dayCounter <= 30) {
                countdownDisplay.classList.add('countdown-warning');
            }

            // Kiểm tra kết thúc
            if (dayCounter <= 0) {
                clearInterval(dayCountdown);
                countdownDisplay.textContent = "Hết thời gian!";
                logEvent("⏰ Thời gian ban ngày đã kết thúc");
                return;
            }

            dayCounter--;
        }

        // Bắt đầu đếm ngược
        updateCountdown(); // Cập nhật lần đầu ngay lập tức
        dayCountdown = setInterval(updateCountdown, 1000);

        // Log sự kiện
        logEvent("🌞 Ban ngày bắt đầu - 5 phút thảo luận");
    }

    // Thêm hàm để lấy thời gian hiện tại
    function getCurrentDayTime() {
        const dayTimeInput = document.getElementById('dayTime');
        return dayTimeInput ? parseInt(dayTimeInput.value) : currentDayTime;
    }

    // Khởi tạo khi trang được load
    document.addEventListener('DOMContentLoaded', () => {
        renderInitialSetup();
    });

    // Thêm event listener để load state khi trang được tải
    document.addEventListener('DOMContentLoaded', () => {
        loadGameState();
    });

    // Thêm event listener để lưu state trước khi trang được đóng/refresh
    window.addEventListener('beforeunload', () => {
        saveGameState();
    });

    // Thêm hàm để xóa dữ liệu đã lưu
    function clearSavedGame() {
        // Xóa dữ liệu từ localStorage
        localStorage.removeItem('werewolfGameState');
        
        // Reset các biến trạng thái
        players = [];
        lovePair = [];
        protectedPlayer = null;
        completedNightRoles.clear();
        hasBlackPotion = true;
        hasWhitePotion = true;
        
        // Reset giao diện
        document.getElementById('initialSetup').style.display = 'block';
        document.getElementById('gameInterface').style.display = 'none';
        document.getElementById('initialPlayersGrid').innerHTML = '';
        document.getElementById('startGameBtn').style.display = 'none';
        
        // Log sự kiện
        logEvent("🗑️ Đã xóa toàn bộ dữ liệu trò chơi");
    }

    // Thêm hàm xác nhận xóa dữ liệu
    function confirmClearData() {
        const confirmed = confirm("Bạn có chắc chắn muốn xóa tất cả dữ liệu đã lưu? Hành động này không thể hoàn tác.");
        if (confirmed) {
            clearSavedGame();
        }
    }

    // Sửa lại hàm loadGameState để đảm bảo logs được tải và hiển thị
    function loadGameState() {
        const savedState = localStorage.getItem('werewolfGameState');
        if (savedState) {
            try {
                const gameState = JSON.parse(savedState);
                
                // Khôi phục trạng thái game
                players = gameState.players || [];
                lovePair = gameState.lovePair || [];
                protectedPlayer = gameState.protectedPlayer || null;
                completedNightRoles = new Set(gameState.completedNightRoles || []);
                hasBlackPotion = gameState.hasBlackPotion ?? true;
                hasWhitePotion = gameState.hasWhitePotion ?? true;
                
                // Khôi phục logs
                gameLogs = gameState.gameLogs || [];
                
                // Nếu có người chơi, hiển thị giao diện game và logs
                if (players.length > 0) {
                    document.getElementById('initialSetup').style.display = 'none';
                    document.getElementById('gameInterface').style.display = 'block';
                    renderPlayers();
                }
                
                // Render logs ngay cả khi không có người chơi
                renderGameLogs();
                
                console.log('Loaded game state:', gameState); // Debug log
                console.log('Loaded logs:', gameLogs); // Debug log
            } catch (error) {
                console.error('Error loading game state:', error);
            }
        }
    }

    // Sửa lại hàm renderGameLogs để đảm bảo hiển thị đúng
    function renderGameLogs() {
        const gameLog = document.getElementById('gameLog');
        if (!gameLog) {
            console.error('Game log element not found');
            return;
        }
        
        // Clear existing logs
        gameLog.innerHTML = '';
        
        // Ensure gameLogs exists
        if (!Array.isArray(gameLogs)) {
            gameLogs = [];
        }
        
        // Render each log entry
        gameLogs.forEach(log => {
            const li = document.createElement('li');
            li.innerHTML = `<span class="log-time">[${log.time}]</span> ${log.event}`;
            li.style.animation = 'newLog 0.5s ease-out';
            gameLog.appendChild(li);
        });
        
        console.log('Rendered logs:', gameLogs); // Debug log
    }

    // Sửa lại hàm logEvent để đảm bảo lưu đúng
    function logEvent(event) {
        // Ensure gameLogs exists
        if (!Array.isArray(gameLogs)) {
            gameLogs = [];
        }

        const now = new Date();
        const time = now.toLocaleTimeString('vi-VN', { 
            hour: '2-digit', 
            minute: '2-digit',
            second: '2-digit'
        });
        
        const logEntry = {
            time,
            event,
            timestamp: now.getTime()
        };
        
        // Add to logs array
        gameLogs.unshift(logEntry);
        
        // Render and save immediately
        renderGameLogs();
        saveGameState();
        
        console.log('Added new log:', logEntry); // Debug log
    }

    // Thêm event listener để load state khi trang được tải
    document.addEventListener('DOMContentLoaded', () => {
        loadGameState();
        console.log('DOM Content Loaded - Game State Loaded'); // Debug log
    });

    // Thêm event listener để lưu state trước khi trang được đóng/refresh
    window.addEventListener('beforeunload', () => {
        saveGameState();
        console.log('Before Unload - Game State Saved'); // Debug log
    });
</script>
<!-- Thêm modal vào body -->
<div class="modal-overlay" id="modalOverlay"></div>
<div class="login-modal" id="loginModal">
    <h3>Thông báo đăng nhập</h3>
    <p>Bạn cần đăng nhập để dùng các công cụ tool. Vì một số lý do cộng đồng nên rất cần thiết để quản lý người dùng.</p>
    <div class="modal-buttons">
        <a href="/login.html" class="modal-btn modal-login">Đăng nhập</a>
        <a href="/register.html" class="modal-btn modal-register">Đăng ký</a>
    </div>
</div>
    <script>
  gtag('event', 'conversion', {
      'send_to': 'AW-813887593/6FRmCOTRzPgZEOngi4QD',
      'value': 1.0,
      'currency': 'VND'
  });
</script>
</body>
</html>
